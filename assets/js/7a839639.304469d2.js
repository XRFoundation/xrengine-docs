"use strict";(self.webpackChunk_xrengine_docs=self.webpackChunk_xrengine_docs||[]).push([[6896],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return h}});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=o.createContext({}),c=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=c(e.components);return o.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=c(n),h=a,m=u["".concat(s,".").concat(h)]||u[h]||d[h]||r;return n?o.createElement(m,i(i({ref:t},p),{},{components:n})):o.createElement(m,i({ref:t},p))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var c=2;c<r;c++)i[c]=n[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}u.displayName="MDXCreateElement"},7030:function(e,t,n){n.r(t),n.d(t,{contentTitle:function(){return s},default:function(){return u},frontMatter:function(){return l},metadata:function(){return c},toc:function(){return p}});var o=n(7462),a=n(3366),r=(n(7294),n(3905)),i=["components"],l={},s="Projects",c={unversionedId:"projects_editor_scenes/projects-api",id:"projects_editor_scenes/projects-api",title:"Projects",description:"Projects are folders that contain all your custom code, assets and scenes. They are version controlled using git & github, and can be installed to any deployment with a single click. (more on that in the next chapter)",source:"@site/docs/2_projects_editor_scenes/01_projects-api.md",sourceDirName:"2_projects_editor_scenes",slug:"/projects_editor_scenes/projects-api",permalink:"/xrengine-docs/docs/projects_editor_scenes/projects-api",editUrl:"https://github.com/XRFoundation/XREngine/packages/docs/docs/2_projects_editor_scenes/01_projects-api.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{}},p=[{value:"Configuration",id:"configuration",children:[],level:2},{value:"Local Install Flow",id:"local-install-flow",children:[],level:2},{value:"Graphical Install Flow",id:"graphical-install-flow",children:[],level:2},{value:"Config",id:"config",children:[{value:"Hooks",id:"hooks",children:[],level:3},{value:"Thumbnail",id:"thumbnail",children:[],level:3},{value:"Routes",id:"routes",children:[],level:3},{value:"Webapp Injection",id:"webapp-injection",children:[],level:3},{value:"World Injection",id:"world-injection",children:[],level:3},{value:"Services",id:"services",children:[],level:3},{value:"Database Seeding",id:"database-seeding",children:[],level:3}],level:2}],d={toc:p};function u(e){var t=e.components,l=(0,a.Z)(e,i);return(0,r.kt)("wrapper",(0,o.Z)({},d,l,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"projects"},"Projects"),(0,r.kt)("p",null,"Projects are folders that contain all your custom code, assets and scenes. They are version controlled using git & github, and can be installed to any deployment with a single click. (more on that in the ",(0,r.kt)("a",{parentName:"p",href:"./04-editor-scenes-locations.md"},"next chapter"),")"),(0,r.kt)("p",null,"Pictured below is an example of 4 projects installed. By default, only the 'default-project' is installed, which in a production environment is read only. You can find the default project under ",(0,r.kt)("inlineCode",{parentName:"p"},"/packages/projects/default-project/")),(0,r.kt)("p",null,"In a production environment, the builder process will install all projects according to the ",(0,r.kt)("inlineCode",{parentName:"p"},"project")," database table and will download files from the storage provider. In a local development environment, the local file system is always the source of truth. Any project folders added or removed from the file system will be automatically added or removed from the database. This is to ensure there is no accidental loss of data, as these project folders are all git repositories."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(5792).Z,width:"174",height:"277"})),(0,r.kt)("h2",{id:"configuration"},"Configuration"),(0,r.kt)("p",null,"Projects have a few conventions."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"assets/")," is where files uploaded from the editor will be uploaded to")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"public/")," is for hosting public assets, these will be served from the client ")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"sceneName.scene.json")," is a scene file")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"sceneName.thumbnail.png")," is an auto-generated scene thumbnail file")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"p"},"xrengine.config.ts")," the project configuration, where client routes, database models, feathers services and the project thumbnail can be defined"))),(0,r.kt)("p",null,"A project can also have a package.json to provide custom dependencies. @xrengine/* monorepo dependencies will be symlinked and not needed, but some package managers (such as pnpm) require these to be defined. If so, they should be defined in ",(0,r.kt)("inlineCode",{parentName:"p"},"peerDependencies"),"."),(0,r.kt)("h2",{id:"local-install-flow"},"Local Install Flow"),(0,r.kt)("p",null,"To install a project locally, clone the repository you wish to install to the ",(0,r.kt)("inlineCode",{parentName:"p"},"/packages/projects/projects/")," folder. You can do this with the follow commands:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"cd packages/projects/projects/\ngit clone https://github.com/myorg/myrepo\ncd myrepo \ncode .\n")),(0,r.kt)("p",null,"This will create a folder name ",(0,r.kt)("inlineCode",{parentName:"p"},"myrepo")," which must contain an ",(0,r.kt)("inlineCode",{parentName:"p"},"xrengine.config.ts")," file, and open the project in a new vscode window (such that git commands can be handle by the new window). All you need to do now to run this project is re-run the stack (with ",(0,r.kt)("inlineCode",{parentName:"p"},"npm run dev"),")."),(0,r.kt)("h2",{id:"graphical-install-flow"},"Graphical Install Flow"),(0,r.kt)("p",null,"Projects can also be installed and managed from the /admin/projects route. Click the 'Add Project' "),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(2991).Z,width:"960",height:"490"})),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(1012).Z,width:"960",height:"490"})),(0,r.kt)("p",null,"In local development, the 'Remove Project' button has been disabled, as to ensure no accidental loss of data."),(0,r.kt)("p",null,"This runs ",(0,r.kt)("inlineCode",{parentName:"p"},"git clone")," in the background, same as above, but will then upload all of the repository's files to the storage provider. These files will then be downloaded and installed to the local file system each time the docker builder pod runs. This allows full version controlled access for local development flow and version locking for production deployment."),(0,r.kt)("p",null,"The update button will re-download the git repository to install the latest version of the project."),(0,r.kt)("p",null,"The remove button will remove the folder containing that project. WARNING: Any uncommitted & unpushed files will be lost."),(0,r.kt)("h2",{id:"config"},"Config"),(0,r.kt)("p",null,"The xrengine config file has the following options:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"export interface ProjectConfigInterface {\n  onEvent?: string\n  thumbnail?: string\n  routes?: {\n    [route: string]: {\n      component: () => Promise<{ default: (props: any) => JSX.Element }>\n      props?: {\n        [x: string]: any\n        exact?: boolean\n      }\n    }\n  }\n  webappInjection?: () => Promise<{ default: (props: any) => void | JSX.Element }>\n  worldInjection?: () => Promise<{ default: (world: World) => Promise<void> }>\n  services?: string\n  databaseSeed?: string\n}\n")),(0,r.kt)("h3",{id:"hooks"},"Hooks"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"onEvent")," property is a relative path string that points to a file which must expose an object with properties as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"export interface ProjectEventHooks {\n  onInstall?: (app: Application) => Promise<any>\n  onUpdate?: (app: Application) => Promise<any>\n  onUninstall?: (app: Application) => Promise<any>\n}\n")),(0,r.kt)("p",null,"These functions are called when the project they belong to are installed, updated (such as scenes saved) or uninstalled respectively. This is used in the default xrengine project to install the default avatars. ",(0,r.kt)("a",{parentName:"p",href:"../packages/projects/default-project/projectEventHooks.ts"},"See more"),"."),(0,r.kt)("h3",{id:"thumbnail"},"Thumbnail"),(0,r.kt)("p",null,"This is a URL to a thumbnail for the project."),(0,r.kt)("h3",{id:"routes"},"Routes"),(0,r.kt)("p",null,"Routes enable users to customise the various URL paths of their website utilising dynamic loading of modules. The key of each object represents the path (with leading forward slash included) while the value represents a react component object which gets wrapped in ",(0,r.kt)("inlineCode",{parentName:"p"},"React.lazy()")," and a props object which passes options into the react-dom-router Route component corresponding to the route."),(0,r.kt)("h3",{id:"webapp-injection"},"Webapp Injection"),(0,r.kt)("p",null,"Webapp injection allows logic to be run on all pages, loaded before any routes are loaded. This will soon be extended to allow easy stylesheet injection and other configurables of the webapp."),(0,r.kt)("h3",{id:"world-injection"},"World Injection"),(0,r.kt)("p",null,"World injection allows logic to be run every time a new world is created, currently only when the engine is initialised. This is loaded on all instances of the engine, such as a location and the editor. An example use case of this would be registering custom scene loader and editor prefabs."),(0,r.kt)("h3",{id:"services"},"Services"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"services")," property is a relative path that points to a file which must return type ",(0,r.kt)("inlineCode",{parentName:"p"},"((app: Application) => Promise<any>)[]")," which is run on all gameservers and api servers at startup. This allows users to expose custom feathers services, or whatever other functionality they made need."),(0,r.kt)("h3",{id:"database-seeding"},"Database Seeding"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"databaseSeed")," property is a relative path that points to a file which must return type ",(0,r.kt)("a",{parentName:"p",href:"../packages/common/src/interfaces/ServicesSeedConfig.ts"},(0,r.kt)("inlineCode",{parentName:"a"},"ServicesSeedConfig"),"[]")," which is run when the database seeder is run. This can be useful for setting custom locations, which can be seen in the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/XRFoundation/demo-xrengine-project"},"xrengine demo project"),"."))}u.isMDXComponent=!0},2991:function(e,t,n){t.Z=n.p+"assets/images/projects-admin-install-new-3ee297fdc35bc6eb13dc770ffb07abb5.png"},1012:function(e,t,n){t.Z=n.p+"assets/images/projects-admin-1c3efc23814edd4ae5d543251e84bb80.png"},5792:function(e,t,n){t.Z=n.p+"assets/images/projects-folder-4865f639203f0b2dd7c83530e1ac7a41.png"}}]);